!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i(require("@svgdotjs/svg.js"),require("@svgdotjs/svg.draggable.js")):"function"==typeof define&&define.amd?define(["@svgdotjs/svg.js","@svgdotjs/svg.draggable.js"],i):"object"==typeof exports?exports.PiGeometry=i(require("@svgdotjs/svg.js"),require("@svgdotjs/svg.draggable.js")):t.PiGeometry=i(t["@svgdotjs/svg.js"],t["@svgdotjs/svg.draggable.js"])}(window,(function(t,i){return function(t){var i={};function e(s){if(i[s])return i[s].exports;var r=i[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,e),r.l=!0,r.exports}return e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:s})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var r in t)e.d(s,r,function(i){return t[i]}.bind(null,r));return s},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=2)}([function(i,e){i.exports=t},function(t,e){t.exports=i},function(t,i,e){"use strict";e.r(i);var s=e(0);e(1);class r{constructor(t){return this._geometryPi=t,this._grid=t.mainGrid,this._geometryPi.addPoint(this._grid.minX+.5,0,"OxMin").setVirtual(),this._geometryPi.addPoint(this._grid.maxX-.5,0,"OxMax").setVirtual(),this._geometryPi.addPoint(0,this._grid.minY+.5,"OyMin").setVirtual(),this._geometryPi.addPoint(0,this._grid.maxY-.5,"OyMax").setVirtual(),this._xAxis=this._geometryPi.vector("OxMin","OxMax"),this._yAxis=this._geometryPi.vector("OyMin","OyMax"),this}show(){return this._xAxis.show(),this._yAxis.show(),this}}class h{constructor(t){return this.triangle=t=>{let i=this._geometryPi.width,e=this._geometryPi.height,s=t*Math.sin(Math.PI/3),r=0;this._gridData.type=3,this._gridData.width=+t,this._gridData.height=+s,this._intersections=[];for(let h=-t;h<i;h+=t){r=0;for(let i=e;i>=-s;i-=s)this._group.add(this._geometryPi.draw.polygon([h+r%2*t/2,i,h+t+r%2*t/2,i,h+t/2+r%2*t/2,i+s])),this._intersections.push({x:h+r%2*t/2,y:i}),this._intersections.push({x:h+t+r%2*t/2,y:i}),r++}return this._group.stroke({color:"green",width:1}).fill("transparent"),this},this.hexagonal=t=>{let i=this._geometryPi.width,e=this._geometryPi.height,s=.5*t,r=t*Math.sin(Math.PI/3);this._gridData.type=6,this._gridData.width=+t,this._intersections=[];for(let h=0;h<i;h+=3*t)for(let i=e;i>=-r;i-=2*r)this._group.add(this._geometryPi.draw.line(h,i,h+t,i)),this._group.add(this._geometryPi.draw.line(h,i,h-s,i-r)),this._group.add(this._geometryPi.draw.line(h-s,i-r,h,i-2*r)),this._group.add(this._geometryPi.draw.line(h+t,i,h+t+s,i-r)),this._group.add(this._geometryPi.draw.line(h+t+s,i-r,h+t,i-2*r)),this._group.add(this._geometryPi.draw.line(h+t+s,i-r,h+2*t+s,i-r)),this._intersections.push({x:h,y:i}),this._intersections.push({x:h+t,y:i}),this._intersections.push({x:h+t+s,y:i-r}),this._intersections.push({x:h+t,y:i-2*r}),this._intersections.push({x:h,y:i-2*r}),this._intersections.push({x:h-s,y:i-r});return this._group.stroke({color:"green",width:1}).fill("transparent"),this},this.orthographic=(t,i)=>{let e=this._geometryPi.width,s=this._geometryPi.height;void 0===i&&(i=+t),this._gridData.type=4,this._gridData.width=+t,this._gridData.height=+i;for(let i=0;i<=e;i+=t)this._group.add(this._geometryPi.draw.line(i,0,i,s));for(let t=s;t>=0;t-=i)this._group.add(this._geometryPi.draw.line(0,t,e,t));this._intersections=[];for(let r=0;r<=e;r+=t)for(let t=s;t>=0;t-=i)this._intersections.push({x:r,y:t});return this._group.stroke({color:"red",width:1}),this},this.getOrigin=()=>void 0===this._origin?{x:0,y:this._geometryPi.height}:this._origin,this.setOrigin=(t,i)=>(this._origin=this.getPoint({x:t,y:i},{x:0,y:this._geometryPi.height}),this),this.getPoint=(t,i)=>(void 0===i&&(i=this.getOrigin()),3===this._gridData.type?this._getPointTriangle(t,i):4===this._gridData.type?this._getPointOrtho(t,i):6===this._gridData.type?this._getPointHex(t,i):{x:0,y:0}),this._getPointTriangle=(t,i)=>({x:i.x+t.x*this._gridData.width+Math.abs(t.y)%2*this._gridData.width/2,y:i.y-t.y*this._gridData.height}),this._getPointOrtho=(t,i)=>({x:i.x+t.x*this._gridData.width,y:i.y-t.y*this._gridData.height}),this._getPointHex=(t,i)=>({x:i.x+t.x,y:i.x+t.x}),this.getPointCoordinate=(t,i)=>{if(4===this._gridData.type){let e=this.getOrigin();return{x:(t-e.x)/this._gridData.width,y:-(i-e.y)/this._gridData.height}}return console.log("Getting coordinates does not work for alternatives grids !"),{x:0,y:0}},this.nearestPoint=t=>{let i=!1,e=0,s={x:+t.x,y:+t.y};for(let r of this._intersections)e=Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2),(!1===i||e<i)&&(s={x:+r.x,y:+r.y},i=+e);return s},this._geometryPi=t,this._group=this._geometryPi.draw.group(),this._gridData={width:0,height:0,type:0},this._axis=null,this}showIntersections(){this._intersectionsPoints=this._geometryPi.draw.group();for(let t of this._intersections)this._intersectionsPoints.add(this._geometryPi.draw.circle(3).cx(t.x).cy(t.y));return this}hideIntersections(){return this._intersectionsPoints.remove(),this}showAxis(){return null===this._axis&&(this._axis=new r(this._geometryPi)),this._axis.show(),this}color(t){return this._group.stroke(t),this}width(t){return this._group.stroke({width:t}),this}dash(t){return"number"==typeof t?this._group.stroke({dasharray:`${t} ${t}`}):this._group.stroke({dasharray:t}),this}get intersections(){return this._intersections}get grid(){return this._group}set stroke(t){this._group.stroke(t)}get maxX(){return(this._geometryPi.width-this._origin.x)/this._gridData.width}get minX(){return-this._origin.x/this._gridData.width}get maxY(){return this._origin.y/this._gridData.height}get minY(){return-(this._geometryPi.height-this._origin.y)/this._gridData.height}}class n{constructor(t,i){return this._geometryPi=t,this._text=i,this._textPoint=null,this._textDistance=null,this._textFunction=null,this._textFunctionArgs={},this._position={horizontal:"left",vertical:"bottom"},this._offset={dx:0,dy:0},this._distance=15,this._shape=this._geometryPi.draw.text(""),this._shape.leading(0),this._shape.font({size:this._geometryPi.defaults.font.size}),null!==this._geometryPi.defaults.font.family&&this._shape.font({family:this._geometryPi.defaults.font.family}),this.updateText(),this}update(){this.move(this._x,this._y)}updateText(){let t=null===this._textFunction?this._text:this._textFunction(this,this._textFunctionArgs),i=[],e="",s=0,r=!1,h=!1;for(let n of t)"_"!==n?"\\"!==n?" "!==n?e+=n:(i.push({text:e,dy:+s,indices:!0===r,symbol:!0===h}),s=r?-5:0,h=!1,r=!1,e=""):(i.push({text:e,dy:+s,indices:!0===r,symbol:!0===h}),h=!0,e=""):(i.push({text:e,dy:+s,indices:!0===r,symbol:!0===h}),r=!0,e="",s=5);i.push({text:e,dy:+s,indices:!0===r,symbol:!0===h}),this._shape.text(""),this._shape.build(!0);for(let t of i){let i=this._shape.tspan(t.symbol?this.greekLetter(t.text):t.text).dy(t.dy).font("font-size",t.indices?"110%":"150%");t.symbol&&i.addClass("greek")}this._shape.build(!1)}greekLetter(t){switch(t){case"a":return"α";case"b":return"β";case"c":return"γ";case"d":return"δ";case"e":return"ε";case"z":return"ζ";case"j":return"η";case"h":return"θ";case"i":return"ι";case"k":return"κ";case"l":return"λ";case"m":return"μ";case"n":return"ν";case"x":return"ξ";case"o":return"ο";case"p":return"π";case"r":return"ρ";case"s":return"σ";case"t":return"τ";case"u":return"υ";case"f":return"φ";case"q":return"χ";case"y":return"ψ";case"w":return"ω"}return t}appendCoordinates(){if(null!==this._textPoint){let t=this._textPoint.coord;this._shape.build(!0),this._shape.tspan(`(${(t.x*this._textScale).toFixed(this._textRounding)};${(t.y*this._textScale).toFixed(this._textRounding)})`),this._shape.build(!1)}}appendDistance(){if(null!==this._textDistance){let t=this._textDistance[0].coord,i=this._textDistance[1].coord,e=Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2));this._shape.build(!0),this._shape.tspan((e*this._textScale).toFixed(this._textRounding)),this._shape.build(!1)}}move(t,i){this._x=t,this._y=i,null===this._textPoint&&null===this._textDistance&&null===this._textFunction||this.updateText();let e=+t,s=+i;return"left"===this._position.horizontal?e=e-this.w/2-this._distance:"right"===this._position.horizontal&&(e=e+this.w/2+this._distance),"top"===this._position.vertical?s=s-this.h/2-this._distance:"bottom"===this._position.vertical&&(s=s+this.h/2+this._distance),e+=this._offset.dx,s+=this._offset.dy,this.shape.cx(e).cy(s),this}show(){return this.shape.show(),this}hide(){return this.shape.hide(),this}top(){return this._position.vertical="top",this.move(this._x,this._y),this}bottom(){return this._position.vertical="bottom",this.move(this._x,this._y),this}center(){return this._position.vertical="center",this.move(this._x,this._y),this}left(){return this._position.horizontal="left",this.move(this._x,this._y),this}right(){return this._position.horizontal="right",this.move(this._x,this._y),this}middle(){return this._position.horizontal="middle",this.move(this._x,this._y),this}resetPos(){return this._offset.dx=0,this._offset.dy=0,this._position.horizontal="middle",this._position.vertical="center",this.move(this._x,this._y),this}distance(t){return this._distance=t,this}font(t){return this._shape.font("family",t),this.update(),this}fontSize(t){return this._shape.font("size",t),this.update(),this}offset(t,i){return this._offset.dx=+t,this._offset.dy=+i,this.update(),this}polar(t,i){return this._offset.dx=Math.cos(i*Math.PI/180)*t,this._offset.dy=-Math.sin(i*Math.PI/180)*t,this.update(),this}showCoordinates(t,i=0,e=1){return this._textPoint=t,this._textRounding=i,this._textScale=e,this.update(),this}showDistance(t,i,e=0,s=1){return this._textDistance=[t,i],this._textRounding=e,this._textScale=s,this.update(),this}showTextFunction(t,i){return this._textFunction=t,this._textFunctionArgs=i,this.update(),this}get shape(){return this._shape}get w(){return this.shape.length()}get h(){return this.shape.bbox().h}get text(){return this._text}set text(t){this._text=t}}class a{constructor(t,i){return this._geometryPi=t,this._name=i,this._label=new n(this._geometryPi,this.name).hide(),this._createMarker(10),this._isPoint=!1,this._isVirtual=!1,this}_createMarker(t){this._marker={start:null,end:null},this._marker.start=this.geometryPi.draw.marker(t,t,(function(i){i.path(`M1,0 L1,${t}, L${1.2*t},${t/2} L1,0z`).rotate(180)})).ref(0,t/2),this._marker.end=this.geometryPi.draw.marker(t,t,(function(i){i.path(`M1,0 L1,${t}, L${1.2*t},${t/2} L1,0z`)})).ref(t,t/2)}draggable(){return this}update(){return this.moveLabel(),this}distance(t,i){return Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2))}makeDraggable(){return this.geometryPi.touchDisable(),this}moveLabel(){return this}show(){return this.shape.show(),this}hide(){return this.shape.hide(),this.hideLabel(),this}showLabel(t){return this.isVirtual?this:!1===t?this.hideLabel():(this.label.show(),this.moveLabel(),this)}hideLabel(){return null!==this._label&&this._label.hide(),this}showShape(t){return!1===t?this.hideShape():(this.shape.show(),this)}hideShape(){return this.shape.hide(),this}labelText(t,i){return this._label.text=t,this._label.updateText(),!0===i&&this.showLabel(),this.update(),this}labelFont(t){return this._label.font(t),this}labelFontSize(t){return this._label.fontSize(t),this}labelPos(t){return-1!==t.indexOf("l")&&this.labelLeft(),-1!==t.indexOf("m")&&this.labelMiddle(),-1!==t.indexOf("r")&&this.labelRight(),-1!==t.indexOf("t")&&this.labelTop(),-1!==t.indexOf("c")&&this.labelCenter(),-1!==t.indexOf("b")&&this.labelBottom(),this}labelTop(){return this._label.top(),this}labelBottom(){return this._label.bottom(),this}labelCenter(){return this._label.center(),this}labelLeft(){return this._label.left(),this}labelRight(){return this._label.right(),this}labelMiddle(){return this._label.middle(),this}labelDistance(t){return this._label.distance(t),this}labelReset(){return this._label.resetPos(),this}labelOffset(t,i){return this._label.offset(t,i),this}labelPolar(t,i){return this._label.polar(t,i),this}labelFunction(t,i){return this._label.showTextFunction(t,i),this}setVirtual(t){return this.isVirtual=void 0===t||!0===t,this.isVirtual?this.hide():this.show(),this}color(t){return this.shape.stroke(t),this._marker.start.stroke(t).fill(t),this._marker.end.stroke(t).fill(t),this}width(t){return this.shape.stroke({width:t}),this}dash(t){return"number"==typeof t?this.shape.stroke({dasharray:`${t} ${t}`}):this.shape.stroke({dasharray:t}),this}nofill(){return this.shape.fill("None"),this}fill(t){return this.shape.fill(t),this}get geometryPi(){return this._geometryPi}get name(){return this._name}set name(t){this._name=t}get shape(){return this._shape}set shape(t){this._shape=t}get markerEnd(){return this._marker.end}get markerStart(){return this._marker.start}get label(){return this._label}get isPoint(){return this._isPoint}set isPoint(t){this._isPoint=t}get isVirtual(){return this._isVirtual}set isVirtual(t){this._isVirtual=t}}class l extends a{constructor(t,i,e,s,r){return super(t,i),this._p1=e,this._p2=s,this._conditionRule={rule:null,through:null,k:null},void 0!==r&&(this._conditionRule.rule="rule"in r?r.rule:"",this._conditionRule.through="through"in r?r.through:null,this._conditionRule.k="k"in r?r.k:""),this.shape=t.draw.line(0,0,0,0).stroke("black"),this.update(),this}_getCoordinates(){let t,i,e=this.geometryPi.getPoint(this._p1),s=this.geometryPi.getPoint(this._p2);return this._calculateSlope(),"p"===this._conditionRule.rule&&(this._calculateSlopePerpendicular(),null!==this._conditionRule.through&&(e=this._conditionRule.through)),""===this._conditionRule.k&&(this.stopP2=!1),t=this._stopP1?e:this.slope!==1/0?this._getLinePosAtX(e.x<s.x?0:this.geometryPi.width,e):{x:e.x,y:0},i=this._stopP2?s:this.slope!==1/0?this._getLinePosAtX(e.x<s.x?this.geometryPi.width:0,e):{x:e.x,y:this.geometryPi.height},{x1:t.x,y1:t.y,x2:i.x,y2:i.y}}_getLinePosAtX(t,i){return this.slope!==1/0?{x:t,y:t*this.slope+(i.y-i.x*this.slope)}:{x:t,y:0}}_calculateSlope(){let t,i,e=this.geometryPi.getPoint(this._p1),s=this.geometryPi.getPoint(this._p2);return t=s.x-e.x,i=s.y-e.y,0===t&&0===i&&(this._slope=null),0===t&&(this._slope=1/0),0===i&&(this._slope=0),this._slope=i/t,this._slope}_calculateSlopePerpendicular(){return 0===this._slope?this._slope=1/0:this._slope===1/0?this._slope=0:this._slope=-1/this._slope,this._slope}update(){let{x1:t,y1:i,x2:e,y2:s}=this._getCoordinates();return this.shape.plot(t,i,e,s),this._arrowEnd&&this.shape.marker("end",this.markerEnd),this._arrowStart&&this.shape.marker("start",this.markerStart),super.update(),this}segment(){return this._stopP1=!0,this._stopP2=!0,this._arrowEnd=!1,this._arrowStart=!1,this.update(),this}vector(){return this._stopP1=!0,this._stopP2=!0,this._arrowEnd=!0,this._arrowStart=!1,this.update(),this}halfRule(){return this._stopP1=!0,this._stopP2=!1,this._arrowEnd=!1,this._arrowStart=!1,this.update(),this}line(){return this._stopP1=!1,this._stopP2=!1,this._arrowEnd=!1,this._arrowStart=!1,this.update(),this}perpendicular(t){return"p"===this._conditionRule.rule&&(this._conditionRule.rule=""),this.line(),this._conditionRule.rule="p",this._conditionRule.through=void 0===t?null:t,this._conditionRule.k="",this.update(),this}moveLabel(){return null===this.label?this:(this.label.move((this._p1.x+this._p2.x)/2,(this._p1.y+this._p2.y)/2),this)}labelDistance(t,i){return this.label.showDistance(this._p1,this._p2,void 0===t?0:t,void 0===i?1:i),this}isColinar(t){return t.slope===this.slope}isSame(t){return this.isColinar(t)&&t.size===this.size&&t.direction===this.direction}isOpposed(t){return this.isColinar(t)&&t.size===this.size&&t.direction!==this.direction}isPerpendicular(t){return this.slope===t.slopePerendicular}get p1(){return this._p1}set p1(t){this._p1=t}get p2(){return this._p2}set p2(t){this._p2=t}get stopP1(){return this._stopP1}set stopP1(t){this._stopP1=t}get stopP2(){return this._stopP2}set stopP2(t){this._stopP2=t}get arrowStart(){return this._arrowStart}set arrowStart(t){this._arrowStart=t}get arrowEnd(){return this._arrowEnd}set arrowEnd(t){this._arrowEnd=t}get slopePerendicular(){return 0===this.slope?1/0:Math.round(-1/this.slope*1e5)/1e5}get slope(){return Math.round(1e5*this._slope)/1e5}get size(){return Math.round(10*Math.sqrt(Math.pow(this._p2.x-this._p1.x,2)+Math.pow(this._p2.y-this._p1.y,2)))/10}get direction(){const t=this.p2.x-this.p1.x;return t>0?1:t<0?-1:this.p2.y-this.p1.y>0?1:-1}}class o extends a{constructor(t,i){return super(t,i),this._center=null,this._radius=0,this.shape=t.draw.circle(this.diameter).stroke("black").fill("none"),this}center(t){return this._center=t,this.update(),this}radius(t){return this._radius=t,this.update(),this}update(){let t=this.geometryPi.getPoint(this._center),i=this.diameter;return null===t?this:(this.shape.center(t.x,t.y).width(i).height(i),super.update(),this)}get getRadius(){return Array.isArray(this._radius)?this.distance(this._radius[0],this._radius[1]):this._radius}get diameter(){return 2*this.getRadius}}class u{constructor(t,i){return void 0!==t&&void 0!==i?(this._x=t,this._y=i):(this._x=0,this._y=0),this}from(t,i){return this._x=i.x-t.x,this._y=i.y-t.y,this}clone(){return new u(this._x,this._y)}perpendicular(){let t=+this._x,i=+this._y;return this._x=i,this._y=-t,this}norme(){return Math.sqrt(Math.pow(this._x,2)+Math.pow(this._y,2))}unit(){let t=this.norme();return 0===t?this:this.multiply(1/t)}isNull(){return 0===this.norme()}add(t){return this._x+=t.x,this._y+=t.y,this}sub(t){return this.add(t.clone().opposed())}multiply(t){return this._x*=t,this._y*=t,this}opposed(){return this._x=-this._x,this._y=-this._y,this}static distance(t,i){return Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2))}static midPoint(t,i){return{x:(t.x+i.x)/2,y:(t.y+i.y)/2}}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}}class _ extends a{constructor(t,i){return super(t,i),this.isPoint=!0,this._scale=6,this.shape=t.draw.path(`M${-this._scale},${-this._scale}\n                L${+this._scale},${+this._scale}\n                M${+this._scale},${-this._scale}\n                L${-this._scale},${+this._scale}`).stroke("black").center(0,0),this}update(){return this.shape.center(this._x,this._y),super.update(),this}moveLabel(){return null===this.label?this:(this.label.move(this._x,this._y),this)}labelCoordinate(t,i){return this.label.showCoordinates(this,void 0===t?0:t,void 0===i?1:i),this}distanceTo(t){return this.distance(this,t)}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get coord(){return this.geometryPi.mainGrid.getPointCoordinate(this._x,this._y)}get xCoord(){return this.coord.x}get yCoord(){return this.coord.y}get scale(){return this._scale}set scale(t){this._scale=t}}class d extends _{constructor(t,i){return super(t,i),this._triangle=null,this}update(){if("middle"===this._rule.rule){let t=this.geometryPi.getPoint(this._rule.p1),i=this.geometryPi.getPoint(this._rule.p2);if(null===t||null===i)return console.log("Middle: one point was not found!"),this;this.x=(t.x+i.x)/2,this.y=(t.y+i.y)/2}else if("colinear"===this._rule.rule){let t=this.geometryPi.getPoint(this._rule.p1),i=this.geometryPi.getPoint(this._rule.p2),e=this.geometryPi.getPoint(this._rule.through),s=1;if(null===t||null===i)return console.log("Colinear: one point was not found!"),this;isNaN(Number(this._rule.k))||(s=+this._rule.k),this.x=e.x+s*(i.x-t.x),this.y=e.y+s*(i.y-t.y)}else if("perpendicular"===this._rule.rule){let t=this.geometryPi.getPoint(this._rule.p1),i=this.geometryPi.getPoint(this._rule.p2),e=this.geometryPi.getPoint(this._rule.through),s=1;if(null===t||null===i)return console.log("Perpendicular: one point was not found!"),this;isNaN(Number(this._rule.k))||(s=+this._rule.k),this.x=e.x+s*(i.y-t.y),this.y=e.y-s*(i.x-t.x)}else if("polar"===this._rule.rule){let t=this.geometryPi.getPoint(this._rule.origin),i=this._rule.angle,e=this._rule.distance,s=0;isNaN(i)?"function"==typeof i?s=i(this.geometryPi,this,this._rule.options):"Arc"===i.constructor.name&&(s=i.angle):s=+i,this.x=t.x+Math.cos(+s*Math.PI/180)*+e,this.y=t.y-Math.sin(+s*Math.PI/180)*+e}else if("projection"===this._rule.rule){let t=this.geometryPi.getPoint(this._rule.p);if(null===t)return console.log("Projection: reference point not found"),this;if("Ox"===this._rule.axis){let i=this.geometryPi.mainGrid.getOrigin();this.x=t.x,this.y=i.y}if("Oy"===this._rule.axis){let i=this.geometryPi.mainGrid.getOrigin();this.x=i.x,this.y=t.y}}else if("rectangle"===this._rule.rule){let t=+this._rule.k,i=this.geometryPi.getPoint(this._rule.p1),e=this.geometryPi.getPoint(this._rule.p2);if(null===i||null===e)return console.log("Triangle rectangle: one point was not found!"),this;let s=(new u).from(i,e),r=s.norme()/Math.sqrt(1+t*t),h=Math.atan(t),n=Math.sin(h)*r,a=Math.cos(h)*r,l=new u(i.x,i.y),o=s.clone().perpendicular().unit().multiply(n),_=s.clone().unit().multiply(a);l.add(o).add(_),this.x=l.x,this.y=l.y}else if("triangle"===this._rule.rule){let t;null===this._triangle&&console.log("Triangle not found..."),"A"===this._rule.abc?t=this._triangle.coordinateA():"B"===this._rule.abc?t=this._triangle.coordinateB():"C"===this._rule.abc&&(t=this._triangle.coordinateC()),this.x=t.x,this.y=t.y}else if("function"===this._rule.rule){let{x:t,y:i}=this._rule.fn(this,this._rule.options);this.x=t,this.y=i}return this.shape.center(this.x,this.y),super.update(),this}fromFunction(t,i){return this._rule={rule:"function",fn:t,options:i},this.update(),this}middle(t,i){return this._rule={rule:"middle",p1:t,p2:i},this.update(),this}colinear(t,i,e,s){return void 0===s&&(s=1),this._rule={rule:"colinear",p1:t,p2:i,through:e,k:s},this.update(),this}perpendicular(t,i,e,s){return void 0===s&&(s=1),this._rule={rule:"perpendicular",p1:t,p2:i,through:e,k:s},this.update(),this}polar(t,i,e){return this._rule={rule:"polar",origin:t,angle:i,distance:e},this.update(),this}projection(t,i,e){return this._rule={rule:"projection",p:t,p1:i,p2:e},this.update(),this}fromTriangle(t,i){this._triangle=t;let e=t.name;return i=void 0===i?"C":-1===["A","B","C"].indexOf(i.toUpperCase())?"C":i.toUpperCase(),this._rule={rule:"triangle",triString:e,abc:i},this.update(),this}projectionAxis(t,i){return this._rule={rule:"projection",p:t,axis:i},this.update(),this}projectionX(t){return this.projectionAxis(t,"Ox")}projectionY(t){return this.projectionAxis(t,"Oy")}rectangle(t,i,e){return this._rule={rule:"rectangle",p1:t,p2:i,k:(void 0===e?4/3:e).toString()},this.update(),this}}class g extends a{constructor(t,i){return super(t,i),this._center=null,this._radius=40,this._angleCoordinates=null,this._markAngle=!1,this._square=!1,this._sector=!1,this.label.center().middle(),this._labelDistanceToCenter=1.75,this.shape=t.draw.path(this.getPath()).stroke("black").fill("None"),this}center(t){return this._center=this.geometryPi.getPoint(t),this.update(),this}radius(t){return this._radius=t,this.update(),this}angleABC(t){return this._angleCoordinates=t,this._startAngle=null,this._endAngle=null,this.update(),this}angleStartStop(t,i){return this._angleCoordinates=null,this._startAngle=+t,this._endAngle=+i,this.update(),this}markAngle(){return this._markAngle=!this._markAngle,this.update(),this}marker(t="end",i){return"end"===t?!1===i?this.shape.marker("end",null):this.shape.marker("end",this.markerEnd):!1===i?this.shape.marker("start",null):this.shape.marker("start",this.markerStart),this}square(t){return this._square=!1!==t,this.update(),this}sector(t){return this._sector=!1!==t,this.update(),this}moveLabel(){if(null===this.label)return this;let t=(this._angle<180?1:-1)*(this._startPoint.x+this._endPoint.x-2*this._center.x),i=-(this._angle<180?1:-1)*(this._startPoint.y+this._endPoint.y-2*this._center.y);return this.label.move(this._center.x+t*(this._theRadius*this._labelDistanceToCenter)/Math.sqrt(t*t+i*i),this._center.y-i*(this._theRadius*this._labelDistanceToCenter)/Math.sqrt(t*t+i*i)),this}polarToCartesian(t,i,e,s){var r=-s*Math.PI/180;return{x:t+e*Math.cos(r),y:i+e*Math.sin(r)}}cartesianToAngle(t,i){let e,s=i.x-t.x,r=-(i.y-t.y);if(e=i.x-t.x==0?90:180*Math.atan(r/s)/Math.PI,s>=0)if(r>=0);else for(;e<270;)e+=180;else if(r>=0)for(;e<90;)e+=180;else for(;e<180;)e+=180;return e}getAngles(){let t=0,i=0;return null===this._angleCoordinates?{startAngle:+this._startAngle,endAngle:+this._endAngle}:(2===this._angleCoordinates.length?(t=+this._angleCoordinates[0],i=+this._angleCoordinates[1]):3===this._angleCoordinates.length&&(t=this.cartesianToAngle(this._angleCoordinates[1],this._angleCoordinates[0]),i=this.cartesianToAngle(this._angleCoordinates[1],this._angleCoordinates[2])),{startAngle:t,endAngle:i})}getPath(){if(null===this.center)return"";if(null===this.radius)return"";if(null===this._angleCoordinates&&(void 0===this._startAngle||void 0===this._endAngle))return"";let{startAngle:t,endAngle:i}=this.getAngles(),e=this.isSquare&&this._square?this.getRadius/2:this.getRadius,s=this.polarToCartesian(this._center.x,this._center.y,e,t),r=this.polarToCartesian(this._center.x,this._center.y,e,i);return this._angle=i-t,this._startAngle=+t,this._endAngle=+i,this._startPoint=s,this._endPoint=r,this._theRadius=e,this._square&&this.isSquare?this._describeSquare():this._describeArc()}_describeSquare(){return null===this._center?"":null===this._startAngle||null===this._endAngle?"":["M",this._startPoint.x,this._startPoint.y,"l",this._endPoint.x-this._center.x,this._endPoint.y-this._center.y,"L",this._endPoint.x,this._endPoint.y].join(" ")}_describeArc(){if(null===this._center)return"";if(null===this._theRadius||0===this._theRadius)return"";if(null===this._startAngle||null===this._endAngle)return"";let t=(this._angle+360)%360<=180?0:1,i=0;this._markAngle&&this._startAngle>this._endAngle&&(t=(t+1)%2,i=1);let e=["M",this._startPoint.x,this._startPoint.y,"A",this._theRadius,this._theRadius,0,t,i,this._endPoint.x,this._endPoint.y];return this._sector&&(e=e.concat(["L",this._center.x,this._center.y,"L",this._startPoint.x,this._startPoint.y])),e.join(" ")}update(){return null===this._center?this:null!==this._angleCoordinates||void 0!==this._startAngle&&void 0!==this._endAngle?(this.shape.plot(this.getPath()),super.update(),this):this}get getRadius(){return Array.isArray(this._radius)?this.distance(this._radius[0],this._radius[1]):this._radius}get angle(){return this._angle}get isSquare(){return void 0!==this._angle&&"90.0000"===this._angle.toFixed(4)}}class c extends a{constructor(t,i){return super(t,i),this._rectangleMark=!1,this._angleMark=!1,this.shape=t.draw.polygon([0,0,0,0]).stroke("black").fill("none"),this._angleArcs={},this}setPoints(...t){return this._points=[],this.addPoints(...t),this}addPoints(...t){for(let i of t)this._points.push(i);return this.update(),this}_getPath(){let t=[];for(let i of this._points){let e=this.geometryPi.getPoint(i);null!==e&&(t.push(e.x),t.push(e.y))}return t}update(){return this.shape.plot(this._getPath()),this.updateAngleMark(),super.update(),this}angleMark(t){return this._angleMark=!1!==t,this.updateAngleMark(),this}updateAngleMark(){if(!1===this._angleMark&&!1===this._rectangleMark){for(let t in this._angleArcs)this._angleArcs[t].hide();return this}let t=[];t.push(this.geometryPi.getPoint(this._points[this._points.length-1]));for(let i of this._points)t.push(this.geometryPi.getPoint(i));t.push(this.geometryPi.getPoint(this._points[0]));for(let i=1;i<t.length-1;i++){let e=t[i-1],s=t[i],r=t[i+1],h=`${e.name}${s.name}${r.name}`;h in this._angleArcs?this._angleArcs[h].square(this._rectangleMark).update():this._angleArcs[h]=new g(this.geometryPi,h).center(s).radius(40).angleABC([r,s,e]).square(this._rectangleMark),!1===this._angleMark?this._angleArcs[h].isSquare?this._angleArcs[h].show():this._angleArcs[h].hide():this._angleArcs[h].show()}return this}rectangleMark(t){return this._rectangleMark=!1!==t,this.updateAngleMark(),this}logAngles(){for(let t in this._angleArcs)console.log(t,this._angleArcs[t].angle)}get points(){return this._points}}class p extends _{constructor(t,i,e,s){return super(t,i),this._dragGrid=null,this._dragDistance=null,this._dragTick=null,this._afterDrag=null,this.x=e,this.y=s,this.update(),this}makeDraggable(t){if(this._draggable)return super.makeDraggable(),this;this._draggable=!0,this._dragShape=this.geometryPi.draw.circle(50).center(this.x,this.y).fill("rgba(8,255,103,0.1)").stroke("rgba(79,172,113,0.84)"),this._dragShape.draggable();let i=this.geometryPi,e=this;return this._dragShape.on("dragmove",(function(s){const{handler:r,box:h}=s.detail;let{x:n,y:a}=h;if(s.preventDefault(),!(n<0||n>i.width-h.width/2||a<0||a>i.height-h.width/2)){if(r.move(n,a),null!==e.dragGrid){let t=e.dragGrid.nearestPoint({x:n+h.width/2,y:a+h.height/2});r.move(t.x-h.width/2,t.y-h.height/2)}if(null!==e.dragCenter&&null!==e.dragDistance&&e.dragDistance>0){let t=180*Math.atan(-(h.y-e.dragCenter.y)/(h.x-e.dragCenter.x))/Math.PI;e.dragCenter.x>h.x&&(t=180+t),null!==e._dragTick&&e._dragTick>=0&&(t=Math.round(t/e._dragTick)*e._dragTick),r.move(e.dragCenter.x+Math.cos(t*Math.PI/180)*e.dragDistance-h.width/2,e.dragCenter.y-Math.sin(t*Math.PI/180)*e.dragDistance-h.height/2)}void 0!==t&&void 0!==t.fn&&t.fn(i,e,h,r,t.args),e.x=r.el.cx(),e.y=r.el.cy();for(let t of i.figures)t.update();null!==e._afterDrag&&e._afterDrag(i,e)}})),this._dragShape.front(),super.makeDraggable(),this}afterDrag(t){return this._afterDrag=t,this}setDragGrid(t){return this._dragGrid=t,this}setDistanceTo(t,i,e){return this._dragCenter=t,this._dragDistance=null==i?this.distance(this,t):i,this._dragTick=void 0===e?null:e,this}get dragShape(){return this._dragShape}set dragShape(t){this._dragShape=t}get dragGrid(){return this._dragGrid}get dragCenter(){return this._dragCenter}get dragDistance(){return this._dragDistance}}class y{static round(t,i=2){return Number(Math.round(Number(t+"e"+i))+"e-"+i)}}class x extends a{constructor(t,i){return super(t,i),this.shape=t.draw.polygon([0,0,0,0]).stroke("black").fill("none"),this._A=new p(t,`${i}-point-A`,0,0),this._B=new p(t,`${i}-point-B`,0,0),this._C=new p(t,`${i}-point-C`,0,0),this._AB=new l(t,`${i}-segment-AB`,this._A,this._B).segment(),this._BC=new l(t,`${i}-segment-BC`,this._B,this._C).segment(),this._CA=new l(t,`${i}-segment-CA`,this._C,this._A).segment(),this._rectangleMark=!0,this._rectangleMarkOnly=!1,this._arcBAC=null,this._arcCBA=null,this._arcACB=null,this._createAngleMark(),this._internalFigures=[this._A,this._B,this._C,this._AB,this._BC,this._CA,this._arcBAC,this._arcACB,this._arcCBA],this.hideAll(),this.showAnglesMarks(),this._refA=null,this._refB=null,this._scale=null,this._resetData(),this}_resetData(){return this._a=null,this._b=null,this._c=null,this._alpha=null,this._beta=null,this._gamma=null,this._solution=1,this}base(t,i){return this._refA=t,this._refB=void 0!==i?i:null,this.update(),this}define(t){return this._resetData(),void 0!==t.a&&(this._a=t.a),void 0!==t.b&&(this._b=t.b),void 0!==t.c&&(this._c=t.c),void 0!==t.alpha&&(this._alpha=t.alpha),void 0!==t.beta&&(this._beta=t.beta),void 0!==t.gamma&&(this._gamma=t.gamma),void 0!==t.solution&&this.solution(t.solution,!1),this._calculated=this._calculateTriangle(this._a,this._b,this._c,this._alpha,this._beta,this._gamma,this._solution),this.update(),this}solution(t,i){return(void 0===t||t<1||t>2)&&(t=1),this._solution=+t,i&&(this._calculated=this._calculateTriangle(this._a,this._b,this._c,this._alpha,this._beta,this._gamma,this._solution),this.update()),this}_numberOfKnownAngles(t,i,e){return[t,i,e].filter(t=>null!==t).length}_numberOfKnownSides(t,i,e){return[t,i,e].filter(t=>null!==t).length}_sidesAreAdjacent(t,i,e,s,r,h){return null===t?null!==s:null===i?null!==r:null===e&&null!==h}_calculateTriangle3Sides(t,i,e){let s={a:null,b:null,c:null,alpha:null,beta:null,gamma:null,solution:1};return s.a=+t,s.b=+i,s.c=+e,s.alpha=180*Math.acos((Math.pow(e,2)+Math.pow(i,2)-Math.pow(t,2))/(2*e*i))/Math.PI,s.beta=180*Math.acos((Math.pow(e,2)+Math.pow(t,2)-Math.pow(i,2))/(2*e*t))/Math.PI,s.gamma=180*Math.acos((Math.pow(t,2)+Math.pow(i,2)-Math.pow(e,2))/(2*t*i))/Math.PI,s}_calculateTriangleOneSideTwoAngles(t,i,e,s,r,h){let n={a:null,b:null,c:null,alpha:null,beta:null,gamma:null,solution:1};return n.alpha=null===s?180-r-h:+s,n.beta=null===r?180-s-h:+r,n.gamma=null===h?180-r-s:+h,null!==t?(n.a=+t,n.b=t*Math.sin(n.beta*Math.PI/180)/Math.sin(n.alpha*Math.PI/180),n.c=t*Math.sin(n.gamma*Math.PI/180)/Math.sin(n.alpha*Math.PI/180)):null!==i?(n.a=i*Math.sin(n.alpha*Math.PI/180)/Math.sin(n.beta*Math.PI/180),n.b=+i,n.c=i*Math.sin(n.gamma*Math.PI/180)/Math.sin(n.beta*Math.PI/180)):null!==e&&(n.a=e*Math.sin(n.alpha*Math.PI/180)/Math.sin(n.gamma*Math.PI/180),n.b=e*Math.sin(n.beta*Math.PI/180)/Math.sin(n.gamma*Math.PI/180),n.c=+e),n}_calculateThmSine(t,i,e,s){return 1===s?180*Math.asin(Math.sin(i*Math.PI/180)/t*e)/Math.PI:180-180*Math.asin(Math.sin(i*Math.PI/180)/t*e)/Math.PI}_calculateTriangle(t,i,e,s,r,h,n=1){let a=this._numberOfKnownSides(t,i,e),l=this._numberOfKnownAngles(s,r,h);if(0!==a){if(3===a)return this._calculateTriangle3Sides(t,i,e);if(1===a&&2===l)return this._calculateTriangleOneSideTwoAngles(t,i,e,s,r,h);if(2===a&&1===l)if(this._sidesAreAdjacent(t,i,e,s,r,h)){if(null!==s)return this._calculateTriangle3Sides(Math.sqrt(Math.pow(i,2)+Math.pow(e,2)-2*i*e*Math.cos(s*Math.PI/180)),i,e);if(null!==r)return this._calculateTriangle3Sides(t,Math.sqrt(Math.pow(t,2)+Math.pow(e,2)-2*t*e*Math.cos(r*Math.PI/180)),e);if(null!==h)return this._calculateTriangle3Sides(t,i,Math.sqrt(Math.pow(i,2)+Math.pow(e,2)-2*i*e*Math.cos(h*Math.PI/180)))}else if(null!==s){if(null!==i)return this._calculateTriangleOneSideTwoAngles(t,null,null,s,this._calculateThmSine(t,s,i,n),null);if(null!==e)return this._calculateTriangleOneSideTwoAngles(t,null,null,s,r,this._calculateThmSine(t,s,e,n))}else if(null!==r){if(null!==t)return this._calculateTriangleOneSideTwoAngles(null,i,null,this._calculateThmSine(i,r,t,n),r,null);if(null!==e)return this._calculateTriangleOneSideTwoAngles(null,i,null,null,r,this._calculateThmSine(i,r,e,n))}else if(null!==h){if(null!==t)return this._calculateTriangleOneSideTwoAngles(null,null,e,this._calculateThmSine(e,h,t,n),null,h);if(null!==i)return this._calculateTriangleOneSideTwoAngles(null,null,e,null,this._calculateThmSine(e,h,i,n),h)}return{a:null,b:null,c:null,alpha:null,beta:null,gamma:null,solution:0}}}update(){if(0===this._calculated.solution)return this;let t,i,e;return null===this._refB&&(t=null===this._scale?this._calculated.beta<90?Math.max((this.geometryPi.width-this._A.x-50)/this._calculated.c,(this.geometryPi.height-this._A.y-50)/(this._calculated.b*Math.asin(this._calculated.alpha*Math.PI/180))):Math.max((this.geometryPi.width-this._A.x-50)/(this._calculated.b*Math.acos(this._calculated.alpha*Math.PI/180)),(this.geometryPi.height-this._A.y-50)/(this._calculated.b*Math.asin(this._calculated.alpha*Math.PI/180))):+this._scale),null===this._refA?(this._A.x=0,this._A.y=0):(this._A.x=+this._refA.x,this._A.y=+this._refA.y),null===this._refB?(this._B.x=+this._A.x+this._calculated.c*t,this._B.y=+this._A.y,i=+this._calculated.c,e=0):(this._B.x=this._refB.x,this._B.y=this._refB.y,i=Math.sqrt(Math.pow(this._B.y-this._A.y,2)+Math.pow(this._B.x-this._A.x,2)),e=180*Math.acos((this._B.x-this._A.x)/i)/Math.PI,this._B.y-this._A.y>0&&(e=360-e),t=i/this._calculated.c),this._C.x=this._A.x+this._calculated.b*t*Math.cos((this._calculated.alpha+e)*Math.PI/180),this._C.y=this._A.y-this._calculated.b*t*Math.sin((this._calculated.alpha+e)*Math.PI/180),this.shape.plot([this._A.x,this._A.y,this._B.x,this._B.y,this._C.x,this._C.y]),this._updateInternalPoints(),this}_updateInternalPoints(){this._A.update(),this._B.update(),this._C.update(),this._AB.update(),this._BC.update(),this._CA.update(),this._updateAngleMark()}_createAngleMark(){null===this._arcBAC&&(this._arcBAC=new g(this.geometryPi,`${this.name}-angle-BAC`).center(this._A).radius(40).angleABC([this._B,this._A,this._C]).square(this._rectangleMark)),null===this._arcACB&&(this._arcACB=new g(this.geometryPi,`${this.name}-angle-ACB`).center(this._C).radius(40).angleABC([this._A,this._C,this._B]).square(this._rectangleMark)),null===this._arcCBA&&(this._arcCBA=new g(this.geometryPi,`${this.name}-angle-CBA`).center(this._B).radius(40).angleABC([this._C,this._B,this._A]).square(this._rectangleMark))}_updateAngleMark(){this._arcBAC.square(this._rectangleMark).update(),this._arcCBA.square(this._rectangleMark).update(),this._arcACB.square(this._rectangleMark).update(),this._rectangleMarkOnly&&(this._arcBAC.isSquare?this._arcBAC.show():this._arcBAC.hide(),this._arcACB.isSquare?this._arcACB.show():this._arcACB.hide(),this._arcCBA.isSquare?this._arcCBA.show():this._arcCBA.hide())}rectangleMark(t){return this._rectangleMark=!1!==t,this._updateAngleMark(),this}rectangleMarkOnly(t){return this._rectangleMarkOnly=!1!==t,this._updateAngleMark(),this}log(){return console.log("Donnée:"),console.log({a:this._a,b:this._b,c:this._c,alpha:this._alpha,beta:this._beta,gamma:this._gamma}),console.log("Calculés:"),console.log(this._calculated),this}hideAll(){for(let t of this._internalFigures)t.hide();return this}hideAllLabel(t){for(let t of this._internalFigures)t.hideLabel();return this}showAnglesMarks(){return this._arcBAC.show(),this._arcCBA.show(),this._arcACB.show(),this}A(){return this._A}B(){return this._B}C(){return this._C}BAC(){return this._arcBAC}ACB(){return this._arcACB}CBA(){return this._arcCBA}AB(){return this._AB}BC(){return this._BC}CA(){return this._CA}showLabelData(t){return void 0===t&&(t=!0),t&&this.hideAllLabel(),null!==this._a&&this._BC.labelText(this._a.toString()).showLabel(),null!==this._b&&this._CA.labelText(this._b.toString()).showLabel(),null!==this._c&&this._AB.labelText(this._c.toString()).showLabel(),null===this._alpha||this._arcBAC.isSquare||this._arcBAC.labelText(this._alpha.toString()).showLabel(),null===this._beta||this._arcCBA.isSquare||this._arcCBA.labelText(this._beta.toString()).showLabel(),null===this._gamma||this._arcACB.isSquare||this._arcACB.labelText(this._gamma.toString()).showLabel(),this}showCalculated(t=1,i){return void 0===i&&(i=t),null===this._a&&this._BC.labelText(y.round(this._calculated.a,t).toFixed(t)).showLabel(),null===this._b&&this._CA.labelText(y.round(this._calculated.b,t).toFixed(t)).showLabel(),null===this._c&&this._AB.labelText(y.round(this._calculated.c,t).toFixed(t)).showLabel(),null!==this._alpha||this._arcBAC.isSquare||this._arcBAC.labelText(y.round(this._calculated.alpha,i).toFixed(i)).showLabel(),null!==this._beta||this._arcCBA.isSquare||this._arcCBA.labelText(y.round(this._calculated.beta,i).toFixed(i)).showLabel(),null!==this._gamma||this._arcACB.isSquare||this._arcACB.labelText(y.round(this._calculated.gamma,i).toFixed(i)).showLabel(),this}getDimensions(){return this._calculateTriangle(this._a,this._b,this._c,this._alpha,this._beta,this._gamma,this._solution)}coordinateA(t,i){return{x:this._A.x,y:this._A.y}}coordinateB(t,i){return{x:this._B.x,y:this._B.y}}coordinateC(t,i){return{x:this._C.x,y:this._C.y}}}class m{constructor(t,i,e){return this._container="string"==typeof t?document.getElementById(t):t,this._svgWrapper=document.createElement("DIV"),this._svgWrapper.style.position="relative",this._svgWrapper.style.width="100%",this._svgWrapper.style.height="100%",this._container.appendChild(this._svgWrapper),this._width=i,this._height=e,this._draw=Object(s.SVG)().addTo(this._svgWrapper).size("100%","100%"),this._draw.viewbox(0,0,this._width,this._height),this._grids=[],this._points={},this._figures=[],this._defaults={font:{size:"150%",family:null}},this}dev(){this._draw.circle(80).move(100,150).stroke({width:1,color:"black"}).fill("rgba(200,200,0,0.5)");return this._grids[0].showIntersections(),this}update(){for(let t of this._figures)t.update();return this}touchDisable(t){return this._container.style.touchAction=!0===t?"none":"pinch-zoom",this}touchEnable(){return this._container.style.touchAction="auto",this}showGridOrtho(t,i){return this._grids.push(new h(this).orthographic(t,i)),this}showGridOrthoN(t,i){return void 0===i?this._grids.push(new h(this).orthographic(this._width/t)):this._grids.push(new h(this).orthographic(this._width/t,this._height/i)),this}showGridTri(t){return this._grids.push(new h(this).triangle(t)),this}showGridHex(t){return this._grids.push(new h(this).hexagonal(t)),this}setLabelSize(t){return this.defaultFontSize=t,this}setLabelFamily(t){return this.defaultFontFamily=t,this}showPointsLabel(t){for(let i of this._figures)i.isPoint&&(!1===t?i.hideLabel():i.showLabel());return this}showLabels(t){for(let i of this._figures)!1===t?i.hideLabel():i.showLabel();return this}showPointsShape(t){for(let i of this._figures)i.isPoint&&(!1===t?i.shape.hide():i.shape.show());return this}_checkPointName(t){if(void 0!==t){if(!(t in this._points))return t;let i=t.split("_");return 1===i.length?t+"_1":this._getNextPointNameIndex(i[0],+i[1])}return(this._getNextPointName(),"")}_getNextPointName(t=null){for(let i of"ABCDEFGHIJKLMNOPQRSTUVWXYZ"){let e=`${i}${null===t?"":"_"+t}`;if(!(e in this._points))return e}return this._getNextPointName(null===t?1:t+1)}_getNextPointNameIndex(t,i){let e,s=+i+1;for(;s<100;){if(e=`${t}_${i}`,!(e in this._points))return e;s++,s++}return e+"OVERRIDE"}addPoint(t,i,e){return e="string"==typeof t?this._checkPointName(t):this._checkPointName(e),void 0===i?this.addCPoint(e):this.addSPoint(e,+t,i)}addSPoint(t,i,e){let s=this._grids[0].getPoint({x:i,y:e});return this._points[t]=new p(this,t,s.x,s.y),this._figures.push(this._points[t]),this._points[t]}addCPoint(t){return this._points[t]=new d(this,t),this._figures.push(this._points[t]),this._points[t]}getPoint(t){if("string"!=typeof t)return t;let i=t in this._points?this._points[t]:null;if(null===i)for(let i of this._figures)if(i.name===t)return i;return i}getFigure(t){for(let i of this._figures)if(i.name===t)return i;return null}segment(t,i){let e=this.getPoint(t),s=this.getPoint(i),r=new l(this,`${e.name}${s.name}`,e,s).segment();return this._figures.push(r),r}vector(t,i){let e=this.getPoint(t),s=this.getPoint(i),r=new l(this,`v${e.name}${s.name}`,e,s).vector();return this._figures.push(r),r}perpendicular(t,i,e){let s=this.getPoint(t),r=this.getPoint(i),h=this.getPoint(e),n=new l(this,`p${s.name}${r.name}`,s,r).perpendicular(h);return this._figures.push(n),n}circle(t,i,e){let s=this.getPoint(t),r=new o(this,void 0===e?`c(${s.name};rayon)`:e).center(s);if(Array.isArray(i)){let t=[];for(let e of i)t.push(this.getPoint(e));r.radius(t)}else r.radius(i);return this._figures.push(r),r}arc(t,i,e,s){let r=this.getPoint(t),h=new g(this,void 0===s?`a(${r.name};rayon)`:s).center(r);if(Array.isArray(i)){let t=[];for(let e of i)t.push(this.getPoint(e));h.radius(t)}else h.radius(i);if(3===e.length){let t=[];for(let i of e)"number"!=typeof i&&t.push(this.getPoint(i));h.angleABC(t)}else h.angleStartStop(Number(e[0]),Number(e[1]));return this._figures.push(h),h}triangle(t){let i=new x(this,t);return this._figures.push(i),i}polygon(...t){let i=[],e="";for(let s of t)i.push(this.getPoint(s)),e+=i[i.length-1].name;let s=new c(this,e).setPoints(...i);return this._figures.push(s),s}get(){return this._figures[this._figures.length-1]}get draw(){return this._draw}get width(){return this._width}get height(){return this._height}get grids(){return this._grids}get mainGrid(){return this._grids[0]}get secondaryGrid(){return this._grids[1]}get figures(){return this._figures}get defaults(){return this._defaults}set defaultFontSize(t){this._defaults.font.size=t}set defaultFontFamily(t){this._defaults.font.family=t}}e.d(i,"PiGeometry",(function(){return f})),window.PiGeometry=m;var f={draw:m,v:u}}])}));